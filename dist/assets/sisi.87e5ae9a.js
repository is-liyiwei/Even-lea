var e=(e,t,i)=>new Promise(((l,a)=>{var n=e=>{try{o(i.next(e))}catch(t){a(t)}},s=e=>{try{o(i.throw(e))}catch(t){a(t)}},o=e=>e.done?l(e.value):Promise.resolve(e.value).then(n,s);o((i=i.apply(e,t)).next())}));import{g as t,i,p as l,f as a,R as n,I as s,r as o,o as r,c,j as u,F as h,h as m,t as d,k as p,J as g,w as f,l as v}from"./vendor.5b8de986.js";import{h as w,b as y}from"./index.dca20591.js";var k=new class{constructor(e){this.name=e}static instance(e){return this.i=this.i||new this(e),this.i}get(){const e=localStorage.getItem(this.name);return JSON.parse(e)}set(e){return e=JSON.stringify(e),localStorage.setItem(this.name,e)}remove(){return localStorage.removeItem(this.name)}}("filterList");class x{constructor(e={}){this.reset(e)}updatePage(e=1){this.page+=e}updateLast(e=!1){this.last=e}updateFetching(e=!1){this.fetching=e}updateEpochFrom(e){this.epochFrom=e||0}updateEpochTo(e){this.epochTo=e||1e14}whetherFetch(){return this.fetching||this.last}reset(e={}){this.page=e.page||1,this.take=e.take||10,this.epochFrom=e.epochFrom||0,this.epochTo=e.epochTo||1e14,this.last=e.last||!1,this.fetching=e.fetching||!1,this.list=e.list||[],this.totalNum=e.totalNum||0,this.up=e.up||!0}}function N(e={},t={}){return w({url:"meipai",method:"delete",data:e,query:t})}const C={name:"sisi",components:{},setup(l,a){let o=t(new x),r=t(new x),c=i([]),u=i(!1),h=null;const m=()=>{h=g.service({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"})};function d(e,t){c.value=c.value.filter((t=>t.name!=e.name)),0==c.value.length&&window.location.reload(),document.title=e.name,window.scrollTo(0,0)}let p=t=>e(this,null,(function*(){yield function(e={},t={}){return w({url:"meipai",method:"get",data:e,query:t})}(null,{name:t.name}).then((e=>{let i=[];for(let l=0;l<e.list.length;l++){let a=e.list[l];a=y+"/"+t.name+"/"+a,i.push(a)}c.value.push({name:t.name,currList:i})}))})),f=(e=!0)=>{let t=k.get()||[];if(o.list=o.list.filter((e=>{for(let i=0;i<t.length;i++){if(t[i].name==e.name)return!1}return!0})),o.list=o.list.slice(0,15),e)for(let i=0;i<o.list.length;i++){const e=o.list[i];p(e)}},v=()=>{(function(e={},t={}){return w({url:"meipai/list",method:"get",data:e,query:t})})().then((e=>{e.list.map((e=>{let t=/kt\d{3}/i.exec(e.name);t?e.filterName=t[0]:(e.filterName="00000",console.log("没有序号"),console.log(e.name))})),e.list.sort(((e,t)=>e.filterName.localeCompare(t.filterName)));let t=e.list.map((e=>1*e.filterName.replace(/[^\d]/g,""))),i=[];for(let l=1;l<=238;l++)t.includes(l)||i.push(l);console.log(JSON.stringify(i,null,2)),o.list=e.list,f()}))};return v(),{pageList:o,pageList2:r,allView:c,filterItem:e=>{u.value=!0,m();let t=k.get()||[];t.push(e),k.set(t),d(e),h.close()},viewBigImage:e=>{s({images:[e],transition:"123"})},deleteMeipaiHandle:t=>e(this,null,(function*(){u.value=!0,m(),yield N({item:t}).then((e=>{d(t),h.close()}))})),getMeipaiHandle:p,filterData:f,getList:v,delPatch:()=>{u.value?alert("有过单个操作"):n.confirm("此操作将永久删除，包括当前页面过滤的，请再次确认, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>e(this,null,(function*(){for(let e=0;e<c.value.length;e++){const t=c.value[e];m(),yield N({item:t}),h.close()}window.location.reload()})))).catch((()=>{}))}}}},I=f();l("data-v-249a7862");const b={id:"sisi"},L=v("全部删除"),F={style:{width:"90%",color:"#fff","text-align":"center","background-color":"#f43134"},size:"mini",type:"text"},T={class:"top-ctrl"},S=v("删除"),P=v("过滤"),_=u("br",null,null,-1),z=u("br",null,null,-1);a();const B=I(((e,t,i,l,a,n)=>{const s=o("el-button");return r(),c("div",b,[u(s,{onClick:l.delPatch,size:"mini",type:"danger",class:"del-all"},{default:I((()=>[L])),_:1},8,["onClick"]),(r(!0),c(h,null,m(l.allView,((e,t)=>(r(),c("div",{key:t},[u("div",F,d(e.name),1),u("div",T,[0==t?(r(),c(s,{key:0,size:"mini",onClick:t=>l.deleteMeipaiHandle(e),type:"danger"},{default:I((()=>[S])),_:2},1032,["onClick"])):p("",!0),0==t?(r(),c(s,{key:1,size:"mini",onClick:t=>l.filterItem(e),type:"success"},{default:I((()=>[P])),_:2},1032,["onClick"])):p("",!0)]),_,z,(r(!0),c(h,null,m(e.currList,((e,t)=>(r(),c("img",{onClick:t=>l.viewBigImage(e),src:e,key:t,width:"150"},null,8,["onClick","src"])))),128))])))),128))])}));C.render=B,C.__scopeId="data-v-249a7862";export default C;
